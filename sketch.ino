#include <Servo.h>

const int SERVO0_PIN = 2;
const int SERVO1_PIN = 3;
const int SERVO2_PIN = 4;
const float l1 = 7.3;
const float l2 = 6.3;

const int VERTICAL_ANGLE = 30;

Servo servo0;
Servo servo1;
Servo servo2;

bool pen_on_top = false;

void setup() {
  servo0.attach(SERVO0_PIN);
  servo1.attach(SERVO1_PIN);
  servo2.attach(SERVO2_PIN);

  Serial.begin(9600);
  servo0.write(0);
  servo1.write(90);
  servo2.write(90);
  delay(3000);

  move(correctX(24.424), correctY(43.865));
  delay(100);
  move(correctX(25.607), correctY(42.597));
  delay(100);
  move(correctX(26.350), correctY(41.900));
  delay(100);
  move(correctX(27.113), correctY(41.230));
  delay(100);
  move(correctX(28.736), correctY(39.965));
  delay(100);
  move(correctX(30.381), correctY(38.733));
  delay(100);
  move(correctX(32.012), correctY(37.623));
  delay(100);
  move(correctX(33.658), correctY(36.543));
  delay(100);
  move(correctX(34.816), correctY(35.829));
  delay(100);
  move(correctX(36.010), correctY(35.139));
  delay(100);
  move(correctX(36.907), correctY(34.742));
  delay(100);
  move(correctX(37.811), correctY(34.393));
  delay(100);
  move(correctX(40.021), correctY(33.694));
  delay(100);
  move(correctX(42.248), correctY(33.030));
  delay(100);
  move(correctX(43.873), correctY(32.684));
  delay(100);
  move(correctX(47.244), correctY(31.747));
  delay(100);
  move(correctX(50.593), correctY(30.762));
  delay(100);
  move(correctX(53.145), correctY(29.746));
  delay(100);
  move(correctX(55.791), correctY(28.778));
  delay(100);
  move(correctX(58.237), correctY(28.552));
  delay(100);
  move(correctX(60.666), correctY(28.485));
  delay(100);
  move(correctX(61.655), correctY(28.548));
  delay(100);
  move(correctX(62.698), correctY(28.757));
  delay(100);
  move(correctX(63.709), correctY(29.529));
  delay(100);
  move(correctX(64.583), correctY(30.388));
  delay(100);
  move(correctX(66.902), correctY(33.800));
  delay(100);
  move(correctX(68.045), correctY(34.810));
  delay(100);
  move(correctX(69.009), correctY(35.924));
  delay(100);
  move(correctX(70.697), correctY(37.438));
  delay(100);
  move(correctX(72.429), correctY(39.042));
  delay(100);
  move(correctX(73.478), correctY(40.697));
  delay(100);
  move(correctX(74.289), correctY(41.133));
  delay(100);
  move(correctX(72.252), correctY(44.067));
  delay(100);
  move(correctX(70.715), correctY(46.199));
  delay(100);
  move(correctX(69.235), correctY(47.693));
  delay(100);
  move(correctX(67.408), correctY(49.970));
  delay(100);
  move(correctX(64.557), correctY(52.936));
  delay(100);
  move(correctX(61.684), correctY(55.860));
  delay(100);
  move(correctX(60.574), correctY(56.931));
  delay(100);
  move(correctX(59.404), correctY(57.970));
  delay(100);
  move(correctX(57.279), correctY(59.412));
  delay(100);
  move(correctX(55.117), correctY(60.784));
  delay(100);
  move(correctX(53.856), correctY(61.441));
  delay(100);
  move(correctX(52.572), correctY(62.056));
  delay(100);
  move(correctX(52.017), correctY(62.262));
  delay(100);
  move(correctX(51.411), correctY(62.424));
  delay(100);
  move(correctX(50.023), correctY(62.448));
  delay(100);
  move(correctX(48.688), correctY(62.425));
  delay(100);
  move(correctX(47.643), correctY(62.384));
  delay(100);
  move(correctX(46.560), correctY(62.283));
  delay(100);
  move(correctX(45.323), correctY(61.879));
  delay(100);
  move(correctX(44.146), correctY(61.427));
  delay(100);
  move(correctX(42.993), correctY(60.917));
  delay(100);
  move(correctX(41.852), correctY(60.349));
  delay(100);
  move(correctX(40.154), correctY(59.226));
  delay(100);
  move(correctX(38.481), correctY(58.051));
  delay(100);
  move(correctX(37.803), correctY(57.388));
  delay(100);
  move(correctX(36.091), correctY(56.137));
  delay(100);
  move(correctX(34.740), correctY(54.980));
  delay(100);
  move(correctX(33.427), correctY(53.764));
  delay(100);
  move(correctX(29.752), correctY(49.309));
  delay(100);
  move(correctX(25.258), correctY(45.131));
  delay(100);
  move(correctX(24.942), correctY(44.707));
  delay(100);
  move(correctX(24.817), correctY(44.504));
  delay(100);
  move(correctX(23.267), correctY(42.573));
  delay(100);
  move(correctX(23.664), correctY(44.333));
  delay(100);
  move(correctX(24.108), correctY(45.055));
  delay(100);
  move(correctX(22.645), correctY(45.754));
  delay(100);
  move(correctX(22.656), correctY(44.982));
  delay(100);
  move(correctX(22.786), correctY(44.636));
  delay(100);
  move(correctX(23.253), correctY(43.664));
  delay(100);
  move(correctX(23.271), correctY(43.694));
  delay(100);
  move(correctX(31.818), correctY(54.962));
  delay(100);
  move(correctX(30.975), correctY(53.831));
  delay(100);
  move(correctX(29.683), correctY(52.275));
  delay(100);
  move(correctX(28.346), correctY(50.746));
  delay(100);
  move(correctX(23.566), correctY(46.303));
  delay(100);
  move(correctX(23.029), correctY(46.560));
  delay(100);
  move(correctX(22.661), correctY(46.560));
  delay(100);
  move(correctX(22.320), correctY(46.500));
  delay(100);
  move(correctX(22.053), correctY(46.285));
  delay(100);
  move(correctX(21.846), correctY(46.026));
  delay(100);
  move(correctX(21.757), correctY(45.449));
  delay(100);
  move(correctX(21.766), correctY(44.814));
  delay(100);
  move(correctX(21.964), correctY(44.285));
  delay(100);
  move(correctX(22.378), correctY(43.423));
  delay(100);
  move(correctX(22.390), correctY(43.255));
  delay(100);
  move(correctX(22.498), correctY(42.975));
  delay(100);
  move(correctX(22.645), correctY(42.741));
  delay(100);
  move(correctX(22.983), correctY(42.536));
  delay(100);
  move(correctX(24.190), correctY(41.185));
  delay(100);
  move(correctX(25.001), correctY(40.426));
  delay(100);
  move(correctX(25.846), correctY(39.690));
  delay(100);
  move(correctX(27.515), correctY(38.380));
  delay(100);
  move(correctX(29.207), correctY(37.102));
  delay(100);
  move(correctX(30.871), correctY(35.981));
  delay(100);
  move(correctX(32.561), correctY(34.881));
  delay(100);
  move(correctX(34.444), correctY(33.701));
  delay(100);
  move(correctX(32.946), correctY(32.849));
  delay(100);
  move(correctX(32.320), correctY(32.443));
  delay(100);
  move(correctX(31.009), correctY(31.490));
  delay(100);
  move(correctX(29.737), correctY(30.509));
  delay(100);
  move(correctX(28.957), correctY(29.773));
  delay(100);
  move(correctX(28.220), correctY(29.007));
  delay(100);
  move(correctX(27.750), correctY(28.367));
  delay(100);
  move(correctX(27.358), correctY(27.738));
  delay(100);
  move(correctX(27.288), correctY(27.452));
  delay(100);
  move(correctX(27.277), correctY(27.205));
  delay(100);
  move(correctX(27.425), correctY(26.872));
  delay(100);
  move(correctX(27.620), correctY(26.587));
  delay(100);
  move(correctX(27.925), correctY(26.438));
  delay(100);
  move(correctX(28.260), correctY(26.351));
  delay(100);
  move(correctX(28.592), correctY(26.433));
  delay(100);
  move(correctX(28.910), correctY(26.581));
  delay(100);
  move(correctX(29.265), correctY(27.044));
  delay(100);
  move(correctX(29.698), correctY(27.667));
  delay(100);
  move(correctX(30.311), correctY(28.310));
  delay(100);
  move(correctX(30.946), correctY(28.916));
  delay(100);
  move(correctX(32.191), correctY(29.870));
  delay(100);
  move(correctX(33.444), correctY(30.789));
  delay(100);
  move(correctX(33.859), correctY(31.067));
  delay(100);
  move(correctX(34.385), correctY(31.371));
  delay(100);
  move(correctX(34.850), correctY(31.386));
  delay(100);
  move(correctX(35.194), correctY(31.560));
  delay(100);
  move(correctX(35.498), correctY(31.763));
  delay(100);
  move(correctX(35.618), correctY(31.980));
  delay(100);
  move(correctX(35.703), correctY(32.246));
  delay(100);
  move(correctX(35.661), correctY(33.073));
  delay(100);
  move(correctX(36.989), correctY(32.561));
  delay(100);
  move(correctX(38.503), correctY(32.069));
  delay(100);
  move(correctX(40.930), correctY(31.318));
  delay(100);
  move(correctX(40.782), correctY(30.845));
  delay(100);
  move(correctX(40.707), correctY(29.510));
  delay(100);
  move(correctX(40.665), correctY(28.038));
  delay(100);
  move(correctX(40.078), correctY(25.419));
  delay(100);
  move(correctX(40.033), correctY(24.690));
  delay(100);
  move(correctX(40.050), correctY(24.010));
  delay(100);
  move(correctX(40.150), correctY(23.738));
  delay(100);
  move(correctX(40.278), correctY(23.526));
  delay(100);
  move(correctX(40.587), correctY(23.333));
  delay(100);
  move(correctX(40.927), correctY(23.191));
  delay(100);
  move(correctX(41.179), correctY(23.206));
  delay(100);
  move(correctX(41.432), correctY(23.274));
  delay(100);
  move(correctX(41.715), correctY(23.509));
  delay(100);
  move(correctX(41.924), correctY(23.762));
  delay(100);
  move(correctX(41.989), correctY(24.282));
  delay(100);
  move(correctX(42.041), correctY(25.009));
  delay(100);
  move(correctX(42.363), correctY(26.406));
  delay(100);
  move(correctX(42.639), correctY(27.725));
  delay(100);
  move(correctX(42.680), correctY(28.895));
  delay(100);
  move(correctX(42.645), correctY(30.953));
  delay(100);
  move(correctX(48.461), correctY(29.330));
  delay(100);
  move(correctX(48.847), correctY(27.715));
  delay(100);
  move(correctX(49.218), correctY(26.389));
  delay(100);
  move(correctX(49.522), correctY(24.937));
  delay(100);
  move(correctX(49.800), correctY(23.459));
  delay(100);
  move(correctX(49.829), correctY(22.458));
  delay(100);
  move(correctX(49.990), correctY(22.115));
  delay(100);
  move(correctX(50.188), correctY(21.820));
  delay(100);
  move(correctX(50.405), correctY(21.701));
  delay(100);
  move(correctX(50.669), correctY(21.616));
  delay(100);
  move(correctX(50.954), correctY(21.636));
  delay(100);
  move(correctX(51.212), correctY(21.701));
  delay(100);
  move(correctX(51.485), correctY(21.931));
  delay(100);
  move(correctX(51.693), correctY(22.189));
  delay(100);
  move(correctX(51.786), correctY(22.792));
  delay(100);
  move(correctX(51.801), correctY(23.503));
  delay(100);
  move(correctX(51.515), correctY(25.174));
  delay(100);
  move(correctX(51.155), correctY(26.875));
  delay(100);
  move(correctX(50.706), correctY(28.597));
  delay(100);
  move(correctX(53.631), correctY(27.450));
  delay(100);
  move(correctX(55.138), correctY(26.888));
  delay(100);
  move(correctX(55.875), correctY(26.742));
  delay(100);
  move(correctX(57.356), correctY(26.574));
  delay(100);
  move(correctX(57.220), correctY(25.849));
  delay(100);
  move(correctX(57.296), correctY(25.439));
  delay(100);
  move(correctX(57.445), correctY(25.051));
  delay(100);
  move(correctX(59.937), correctY(22.293));
  delay(100);
  move(correctX(61.496), correctY(19.655));
  delay(100);
  move(correctX(61.785), correctY(19.501));
  delay(100);
  move(correctX(62.140), correctY(19.401));
  delay(100);
  move(correctX(62.398), correctY(19.444));
  delay(100);
  move(correctX(62.660), correctY(19.537));
  delay(100);
  move(correctX(62.867), correctY(19.723));
  delay(100);
  move(correctX(63.028), correctY(19.932));
  delay(100);
  move(correctX(63.106), correctY(20.287));
  delay(100);
  move(correctX(63.110), correctY(20.637));
  delay(100);
  move(correctX(62.451), correctY(21.984));
  delay(100);
  move(correctX(61.646), correctY(23.349));
  delay(100);
  move(correctX(60.681), correctY(24.429));
  delay(100);
  move(correctX(58.697), correctY(26.499));
  delay(100);
  move(correctX(60.713), correctY(26.485));
  delay(100);
  move(correctX(62.058), correctY(26.594));
  delay(100);
  move(correctX(63.286), correctY(26.818));
  delay(100);
  move(correctX(64.272), correctY(27.469));
  delay(100);
  move(correctX(65.286), correctY(28.274));
  delay(100);
  move(correctX(65.895), correctY(28.810));
  delay(100);
  move(correctX(67.445), correctY(27.238));
  delay(100);
  move(correctX(69.234), correctY(25.139));
  delay(100);
  move(correctX(69.516), correctY(24.934));
  delay(100);
  move(correctX(69.780), correctY(24.797));
  delay(100);
  move(correctX(70.053), correctY(24.778));
  delay(100);
  move(correctX(70.327), correctY(24.807));
  delay(100);
  move(correctX(70.564), correctY(24.940));
  delay(100);
  move(correctX(70.782), correctY(25.113));
  delay(100);
  move(correctX(70.917), correctY(25.360));
  delay(100);
  move(correctX(71.013), correctY(25.627));
  delay(100);
  move(correctX(71.001), correctY(25.897));
  delay(100);
  move(correctX(70.938), correctY(26.149));
  delay(100);
  move(correctX(69.985), correctY(27.356));
  delay(100);
  move(correctX(68.912), correctY(28.603));
  delay(100);
  move(correctX(68.192), correctY(29.351));
  delay(100);
  move(correctX(67.450), correctY(30.065));
  delay(100);
  move(correctX(66.978), correctY(30.448));
  delay(100);
  move(correctX(67.803), correctY(31.685));
  delay(100);
  move(correctX(68.277), correctY(32.350));
  delay(100);
  move(correctX(68.869), correctY(32.881));
  delay(100);
  move(correctX(69.417), correctY(33.339));
  delay(100);
  move(correctX(71.772), correctY(35.859));
  delay(100);
  move(correctX(72.923), correctY(36.822));
  delay(100);
  move(correctX(73.977), correctY(37.751));
  delay(100);
  move(correctX(74.321), correctY(38.237));
  delay(100);
  move(correctX(75.188), correctY(39.686));
  delay(100);
  move(correctX(76.412), correctY(37.703));
  delay(100);
  move(correctX(76.614), correctY(37.478));
  delay(100);
  move(correctX(76.897), correctY(37.325));
  delay(100);
  move(correctX(77.139), correctY(37.236));
  delay(100);
  move(correctX(77.489), correctY(37.281));
  delay(100);
  move(correctX(77.832), correctY(37.381));
  delay(100);
  move(correctX(78.017), correctY(37.554));
  delay(100);
  move(correctX(78.172), correctY(37.769));
  delay(100);
  move(correctX(78.243), correctY(38.126));
  delay(100);
  move(correctX(78.235), correctY(38.463));
  delay(100);
  move(correctX(77.242), correctY(40.212));
  delay(100);
  move(correctX(76.094), correctY(42.029));
  delay(100);
  move(correctX(74.217), correctY(44.752));
  delay(100);
  move(correctX(72.303), correctY(47.412));
  delay(100);
  move(correctX(70.770), correctY(48.975));
  delay(100);
  move(correctX(70.029), correctY(49.873));
  delay(100);
  move(correctX(70.525), correctY(50.217));
  delay(100);
  move(correctX(70.728), correctY(50.631));
  delay(100);
  move(correctX(70.981), correctY(51.234));
  delay(100);
  move(correctX(72.764), correctY(54.130));
  delay(100);
  move(correctX(74.617), correctY(56.985));
  delay(100);
  move(correctX(75.449), correctY(57.867));
  delay(100);
  move(correctX(76.315), correctY(58.685));
  delay(100);
  move(correctX(77.234), correctY(59.448));
  delay(100);
  move(correctX(77.382), correctY(59.702));
  delay(100);
  move(correctX(77.471), correctY(59.946));
  delay(100);
  move(correctX(77.430), correctY(60.304));
  delay(100);
  move(correctX(77.331), correctY(60.633));
  delay(100);
  move(correctX(77.088), correctY(60.862));
  delay(100);
  move(correctX(76.801), correctY(61.045));
  delay(100);
  move(correctX(76.457), correctY(61.067));
  delay(100);
  move(correctX(76.105), correctY(61.023));
  delay(100);
  move(correctX(75.630), correctY(60.708));
  delay(100);
  move(correctX(75.101), correctY(60.274));
  delay(100);
  move(correctX(74.086), correctY(59.326));
  delay(100);
  move(correctX(73.155), correctY(58.343));
  delay(100);
  move(correctX(71.135), correctY(55.286));
  delay(100);
  move(correctX(69.197), correctY(52.162));
  delay(100);
  move(correctX(68.837), correctY(51.389));
  delay(100);
  move(correctX(66.388), correctY(53.986));
  delay(100);
  move(correctX(62.194), correctY(58.170));
  delay(100);
  move(correctX(63.379), correctY(58.635));
  delay(100);
  move(correctX(63.657), correctY(58.817));
  delay(100);
  move(correctX(64.106), correctY(59.747));
  delay(100);
  move(correctX(64.587), correctY(60.871));
  delay(100);
  move(correctX(65.380), correctY(62.292));
  delay(100);
  move(correctX(65.968), correctY(63.736));
  delay(100);
  move(correctX(66.528), correctY(65.206));
  delay(100);
  move(correctX(67.009), correctY(66.815));
  delay(100);
  move(correctX(67.632), correctY(68.372));
  delay(100);
  move(correctX(67.784), correctY(69.067));
  delay(100);
  move(correctX(67.875), correctY(69.722));
  delay(100);
  move(correctX(67.814), correctY(70.013));
  delay(100);
  move(correctX(67.713), correctY(70.273));
  delay(100);
  move(correctX(67.523), correctY(70.467));
  delay(100);
  move(correctX(67.314), correctY(70.617));
  delay(100);
  move(correctX(66.951), correctY(70.680));
  delay(100);
  move(correctX(66.612), correctY(70.680));
  delay(100);
  move(correctX(66.321), correctY(70.509));
  delay(100);
  move(correctX(66.076), correctY(70.288));
  delay(100);
  move(correctX(65.921), correctY(69.762));
  delay(100);
  move(correctX(65.756), correctY(69.036));
  delay(100);
  move(correctX(65.179), correctY(67.593));
  delay(100);
  move(correctX(64.685), correctY(65.993));
  delay(100);
  move(correctX(64.160), correctY(64.594));
  delay(100);
  move(correctX(63.599), correctY(63.193));
  delay(100);
  move(correctX(62.858), correctY(61.879));
  delay(100);
  move(correctX(62.186), correctY(60.388));
  delay(100);
  move(correctX(62.045), correctY(59.995));
  delay(100);
  move(correctX(61.949), correctY(59.631));
  delay(100);
  move(correctX(61.906), correctY(58.477));
  delay(100);
  move(correctX(60.859), correctY(59.370));
  delay(100);
  move(correctX(59.307), correctY(60.476));
  delay(100);
  move(correctX(57.718), correctY(61.548));
  delay(100);
  move(correctX(56.064), correctY(62.538));
  delay(100);
  move(correctX(53.838), correctY(63.681));
  delay(100);
  move(correctX(54.464), correctY(64.477));
  delay(100);
  move(correctX(54.579), correctY(64.705));
  delay(100);
  move(correctX(54.638), correctY(67.275));
  delay(100);
  move(correctX(54.922), correctY(68.696));
  delay(100);
  move(correctX(54.955), correctY(74.102));
  delay(100);
  move(correctX(54.953), correctY(79.560));
  delay(100);
  move(correctX(54.864), correctY(79.963));
  delay(100);
  move(correctX(54.772), correctY(80.216));
  delay(100);
  move(correctX(54.511), correctY(80.440));
  delay(100);
  move(correctX(54.226), correctY(80.607));
  delay(100);
  move(correctX(53.885), correctY(80.600));
  delay(100);
  move(correctX(53.476), correctY(80.538));
  delay(100);
  move(correctX(53.397), correctY(80.498));
  delay(100);
  move(correctX(53.319), correctY(80.438));
  delay(100);
  move(correctX(53.126), correctY(80.185));
  delay(100);
  move(correctX(53.010), correctY(79.954));
  delay(100);
  move(correctX(52.950), correctY(74.645));
  delay(100);
  move(correctX(52.953), correctY(69.102));
  delay(100);
  move(correctX(52.665), correctY(67.601));
  delay(100);
  move(correctX(52.629), correctY(66.322));
  delay(100);
  move(correctX(52.637), correctY(65.028));
  delay(100);
  move(correctX(52.715), correctY(64.307));
  delay(100);
  move(correctX(50.269), correctY(64.424));
  delay(100);
  move(correctX(48.504), correctY(64.425));
  delay(100);
  move(correctX(47.422), correctY(64.372));
  delay(100);
  move(correctX(46.381), correctY(64.267));
  delay(100);
  move(correctX(45.294), correctY(63.960));
  delay(100);
  move(correctX(44.196), correctY(63.586));
  delay(100);
  move(correctX(43.332), correctY(63.236));
  delay(100);
  move(correctX(43.058), correctY(63.627));
  delay(100);
  move(correctX(42.660), correctY(63.459));
  delay(100);
  move(correctX(42.749), correctY(62.986));
  delay(100);
  move(correctX(41.622), correctY(62.481));
  delay(100);
  move(correctX(40.955), correctY(62.150));
  delay(100);
  move(correctX(39.136), correctY(60.965));
  delay(100);
  move(correctX(37.365), correctY(59.723));
  delay(100);
  move(correctX(36.588), correctY(58.976));
  delay(100);
  move(correctX(34.942), correctY(57.782));
  delay(100);
  move(correctX(33.156), correctY(56.253));
  delay(100);
  move(correctX(31.357), correctY(60.415));
  delay(100);
  move(correctX(29.996), correctY(63.448));
  delay(100);
  move(correctX(29.354), correctY(64.698));
  delay(100);
  move(correctX(28.680), correctY(65.932));
  delay(100);
  move(correctX(28.356), correctY(66.450));
  delay(100);
  move(correctX(28.014), correctY(66.939));
  delay(100);
  move(correctX(26.935), correctY(68.150));
  delay(100);
  move(correctX(25.840), correctY(69.318));
  delay(100);
  move(correctX(25.639), correctY(69.462));
  delay(100);
  move(correctX(25.473), correctY(69.545));
  delay(100);
  move(correctX(25.082), correctY(69.563));
  delay(100);
  move(correctX(24.694), correctY(69.534));
  delay(100);
  move(correctX(24.550), correctY(69.457));
  delay(100);
  move(correctX(24.406), correctY(69.343));
  delay(100);
  move(correctX(24.248), correctY(69.086));
  delay(100);
  move(correctX(24.135), correctY(68.822));
  delay(100);
  move(correctX(24.129), correctY(68.555));
  delay(100);
  move(correctX(24.175), correctY(68.331));
  delay(100);
  move(correctX(25.207), correctY(67.110));
  delay(100);
  move(correctX(26.389), correctY(65.782));
  delay(100);
  move(correctX(26.975), correctY(64.899));
  delay(100);
  move(correctX(27.557), correctY(63.838));
  delay(100);
  move(correctX(28.112), correctY(62.763));
  delay(100);
  move(correctX(29.061), correctY(60.382));
  delay(100);
  move(correctX(30.258), correctY(57.781));
  delay(100);
  move(correctX(31.375), correctY(55.559));
  delay(100);
  move(correctX(32.819), correctY(53.968));
  delay(100);
  move(correctX(41.611), correctY(64.124));
  delay(100);
  move(correctX(41.866), correctY(63.974));
  delay(100);
  move(correctX(42.151), correctY(63.860));
  delay(100);
  move(correctX(42.716), correctY(63.830));
  delay(100);
  move(correctX(43.104), correctY(64.258));
  delay(100);
  move(correctX(43.228), correctY(64.528));
  delay(100);
  move(correctX(43.278), correctY(64.750));
  delay(100);
  move(correctX(42.646), correctY(66.646));
  delay(100);
  move(correctX(42.343), correctY(69.237));
  delay(100);
  move(correctX(42.044), correctY(70.606));
  delay(100);
  move(correctX(41.697), correctY(71.967));
  delay(100);
  move(correctX(41.075), correctY(73.789));
  delay(100);
  move(correctX(40.405), correctY(75.565));
  delay(100);
  move(correctX(39.527), correctY(77.009));
  delay(100);
  move(correctX(38.965), correctY(78.295));
  delay(100);
  move(correctX(38.526), correctY(78.899));
  delay(100);
  move(correctX(38.049), correctY(79.471));
  delay(100);
  move(correctX(37.770), correctY(79.682));
  delay(100);
  move(correctX(37.520), correctY(79.822));
  delay(100);
  move(correctX(37.246), correctY(79.835));
  delay(100);
  move(correctX(36.905), correctY(79.819));
  delay(100);
  move(correctX(36.587), correctY(79.534));
  delay(100);
  move(correctX(36.356), correctY(79.275));
  delay(100);
  move(correctX(36.292), correctY(78.946));
  delay(100);
  move(correctX(36.299), correctY(78.626));
  delay(100);
  move(correctX(36.653), correctY(78.093));
  delay(100);
  move(correctX(37.164), correctY(77.406));
  delay(100);
  move(correctX(37.744), correctY(76.140));
  delay(100);
  move(correctX(38.547), correctY(74.822));
  delay(100);
  move(correctX(39.169), correctY(73.206));
  delay(100);
  move(correctX(39.731), correctY(71.595));
  delay(100);
  move(correctX(40.077), correctY(70.251));
  delay(100);
  move(correctX(40.376), correctY(68.892));
  delay(100);
  move(correctX(40.658), correctY(66.384));
  delay(100);
  move(correctX(40.975), correctY(65.449));
  delay(100);
  move(correctX(41.247), correctY(64.774));
  delay(100);
  move(correctX(41.892), correctY(64.217));
  delay(100);
  move(correctX(49.359), correctY(48.949));
  delay(100);
  move(correctX(49.359), correctY(48.546));
  delay(100);
  move(correctX(49.752), correctY(48.438));
  delay(100);
  move(correctX(49.945), correctY(48.760));
  delay(100);
  move(correctX(49.937), correctY(48.773));
  delay(100);
  move(correctX(46.208), correctY(52.970));
  delay(100);
  move(correctX(46.610), correctY(53.182));
  delay(100);
  move(correctX(46.992), correctY(53.328));
  delay(100);
  move(correctX(47.616), correctY(53.483));
  delay(100);
  move(correctX(48.260), correctY(53.604));
  delay(100);
  move(correctX(49.023), correctY(53.620));
  delay(100);
  move(correctX(49.758), correctY(53.605));
  delay(100);
  move(correctX(50.646), correctY(53.549));
  delay(100);
  move(correctX(51.568), correctY(53.446));
  delay(100);
  move(correctX(52.539), correctY(53.130));
  delay(100);
  move(correctX(53.491), correctY(52.757));
  delay(100);
  move(correctX(53.943), correctY(52.465));
  delay(100);
  move(correctX(54.364), correctY(52.142));
  delay(100);
  move(correctX(54.666), correctY(51.819));
  delay(100);
  move(correctX(54.954), correctY(51.437));
  delay(100);
  move(correctX(55.170), correctY(50.808));
  delay(100);
  move(correctX(55.320), correctY(50.185));
  delay(100);
  move(correctX(55.341), correctY(49.274));
  delay(100);
  move(correctX(55.321), correctY(48.398));
  delay(100);
  move(correctX(55.184), correctY(46.755));
  delay(100);
  move(correctX(55.083), correctY(45.892));
  delay(100);
  move(correctX(54.890), correctY(44.993));
  delay(100);
  move(correctX(53.433), correctY(42.349));
  delay(100);
  move(correctX(51.896), correctY(39.772));
  delay(100);
  move(correctX(51.513), correctY(39.345));
  delay(100);
  move(correctX(51.102), correctY(38.976));
  delay(100);
  move(correctX(50.332), correctY(38.412));
  delay(100);
  move(correctX(49.478), correctY(37.891));
  delay(100);
  move(correctX(48.356), correctY(37.633));
  delay(100);
  move(correctX(47.259), correctY(37.471));
  delay(100);
  move(correctX(46.392), correctY(37.452));
  delay(100);
  move(correctX(45.550), correctY(37.470));
  delay(100);
  move(correctX(44.695), correctY(37.509));
  delay(100);
  move(correctX(43.799), correctY(37.615));
  delay(100);
  move(correctX(42.213), correctY(38.200));
  delay(100);
  move(correctX(40.660), correctY(38.894));
  delay(100);
  move(correctX(40.025), correctY(39.446));
  delay(100);
  move(correctX(39.487), correctY(40.065));
  delay(100);
  move(correctX(38.892), correctY(41.114));
  delay(100);
  move(correctX(38.401), correctY(42.241));
  delay(100);
  move(correctX(38.275), correctY(43.714));
  delay(100);
  move(correctX(38.204), correctY(46.353));
  delay(100);
  move(correctX(38.244), correctY(47.643));
  delay(100);
  move(correctX(38.645), correctY(48.849));
  delay(100);
  move(correctX(39.131), correctY(49.978));
  delay(100);
  move(correctX(40.501), correctY(52.520));
  delay(100);
  move(correctX(41.973), correctY(55.048));
  delay(100);
  move(correctX(42.556), correctY(55.629));
  delay(100);
  move(correctX(43.158), correctY(56.123));
  delay(100);
  move(correctX(43.877), correctY(56.662));
  delay(100);
  move(correctX(44.646), correctY(57.172));
  delay(100);
  move(correctX(46.296), correctY(57.945));
  delay(100);
  move(correctX(48.020), correctY(58.639));
  delay(100);
  move(correctX(48.898), correctY(58.694));
  delay(100);
  move(correctX(49.745), correctY(58.642));
  delay(100);
  move(correctX(53.230), correctY(57.891));
  delay(100);
  move(correctX(53.536), correctY(57.866));
  delay(100);
  move(correctX(53.787), correctY(57.876));
  delay(100);
  move(correctX(54.063), correctY(57.985));
  delay(100);
  move(correctX(54.302), correctY(58.122));
  delay(100);
  move(correctX(54.470), correctY(58.348));
  delay(100);
  move(correctX(54.600), correctY(58.599));
  delay(100);
  move(correctX(54.620), correctY(58.872));
  delay(100);
  move(correctX(54.591), correctY(59.138));
  delay(100);
  move(correctX(54.406), correctY(59.448));
  delay(100);
  move(correctX(54.185), correctY(59.677));
  delay(100);
  move(correctX(52.222), correctY(60.193));
  delay(100);
  move(correctX(50.105), correctY(60.618));
  delay(100);
  move(correctX(48.975), correctY(60.698));
  delay(100);
  move(correctX(47.902), correctY(60.649));
  delay(100);
  move(correctX(45.860), correctY(59.899));
  delay(100);
  move(correctX(43.823), correctY(59.007));
  delay(100);
  move(correctX(42.927), correctY(58.437));
  delay(100);
  move(correctX(42.048), correctY(57.794));
  delay(100);
  move(correctX(41.165), correctY(57.072));
  delay(100);
  move(correctX(40.399), correctY(56.320));
  delay(100);
  move(correctX(38.825), correctY(53.637));
  delay(100);
  move(correctX(37.333), correctY(50.848));
  delay(100);
  move(correctX(36.775), correctY(49.546));
  delay(100);
  move(correctX(36.342), correctY(48.253));
  delay(100);
  move(correctX(36.246), correctY(46.735));
  delay(100);
  move(correctX(36.242), correctY(45.144));
  delay(100);
  move(correctX(36.273), correctY(43.443));
  delay(100);
  move(correctX(36.413), correctY(41.841));
  delay(100);
  move(correctX(36.996), correctY(40.441));
  delay(100);
  move(correctX(37.733), correctY(39.076));
  delay(100);
  move(correctX(38.481), correctY(38.173));
  delay(100);
  move(correctX(39.313), correctY(37.397));
  delay(100);
  move(correctX(41.187), correctY(36.488));
  delay(100);
  move(correctX(43.148), correctY(35.711));
  delay(100);
  move(correctX(44.209), correctY(35.551));
  delay(100);
  move(correctX(45.336), correctY(35.470));
  delay(100);
  move(correctX(46.324), correctY(35.445));
  delay(100);
  move(correctX(47.296), correctY(35.469));
  delay(100);
  move(correctX(48.659), correctY(35.656));
  delay(100);
  move(correctX(49.948), correctY(35.938));
  delay(100);
  move(correctX(51.120), correctY(36.591));
  delay(100);
  move(correctX(52.284), correctY(37.364));
  delay(100);
  move(correctX(52.856), correctY(37.857));
  delay(100);
  move(correctX(53.356), correctY(38.394));
  delay(100);
  move(correctX(55.081), correctY(41.226));
  delay(100);
  move(correctX(56.678), correctY(44.110));
  delay(100);
  move(correctX(56.952), correctY(45.201));
  delay(100);
  move(correctX(57.146), correctY(46.377));
  delay(100);
  move(correctX(57.241), correctY(47.274));
  delay(100);
  move(correctX(57.307), correctY(48.181));
  delay(100);
  move(correctX(57.341), correctY(49.255));
  delay(100);
  move(correctX(57.323), correctY(50.286));
  delay(100);
  move(correctX(57.113), correctY(51.234));
  delay(100);
  move(correctX(56.826), correctY(52.139));
  delay(100);
  move(correctX(56.381), correctY(52.820));
  delay(100);
  move(correctX(55.859), correctY(53.472));
  delay(100);
  move(correctX(55.242), correctY(53.983));
  delay(100);
  move(correctX(54.582), correctY(54.433));
  delay(100);
  move(correctX(53.378), correctY(54.937));
  delay(100);
  move(correctX(52.142), correctY(55.361));
  delay(100);
  move(correctX(51.070), correctY(55.503));
  delay(100);
  move(correctX(49.950), correctY(55.591));
  delay(100);
  move(correctX(49.041), correctY(55.618));
  delay(100);
  move(correctX(48.164), correctY(55.606));
  delay(100);
  move(correctX(47.342), correctY(55.461));
  delay(100);
  move(correctX(46.521), correctY(55.265));
  delay(100);
  move(correctX(45.769), correctY(54.991));
  delay(100);
  move(correctX(45.107), correctY(54.670));
  delay(100);
  move(correctX(44.264), correctY(53.857));
  delay(100);
  move(correctX(43.468), correctY(52.945));
  delay(100);
  move(correctX(42.974), correctY(52.113));
  delay(100);
  move(correctX(42.611), correctY(51.279));
  delay(100);
  move(correctX(42.539), correctY(49.864));
  delay(100);
  move(correctX(42.556), correctY(48.367));
  delay(100);
  move(correctX(42.579), correctY(48.177));
  delay(100);
  move(correctX(43.287), correctY(47.321));
  delay(100);
  move(correctX(44.056), correctY(46.534));
  delay(100);
  move(correctX(44.974), correctY(46.042));
  delay(100);
  move(correctX(45.953), correctY(45.661));
  delay(100);
  move(correctX(46.972), correctY(45.565));
  delay(100);
  move(correctX(47.910), correctY(45.617));
  delay(100);
  move(correctX(48.630), correctY(46.087));
  delay(100);
  move(correctX(49.391), correctY(46.732));
  delay(100);
  move(correctX(50.002), correctY(47.388));
  delay(100);
  move(correctX(50.573), correctY(48.070));
  delay(100);
  move(correctX(50.732), correctY(48.336));
  delay(100);
  move(correctX(50.829), correctY(48.562));
  delay(100);
  move(correctX(50.834), correctY(48.844));
  delay(100);
  move(correctX(50.791), correctY(49.105));
  delay(100);
  move(correctX(50.395), correctY(49.686));
  delay(100);
  move(correctX(49.940), correctY(50.220));
  delay(100);
  move(correctX(49.702), correctY(50.326));
  delay(100);
  move(correctX(49.430), correctY(50.391));
  delay(100);
  move(correctX(49.154), correctY(50.349));
  delay(100);
  move(correctX(48.911), correctY(50.268));
  delay(100);
  move(correctX(48.651), correctY(50.010));
  delay(100);
  move(correctX(48.467), correctY(49.751));
  delay(100);
  move(correctX(48.467), correctY(48.715));
  delay(100);
  move(correctX(47.916), correctY(48.094));
  delay(100);
  move(correctX(47.303), correctY(47.587));
  delay(100);
  move(correctX(46.893), correctY(47.536));
  delay(100);
  move(correctX(46.563), correctY(47.575));
  delay(100);
  move(correctX(45.955), correctY(47.789));
  delay(100);
  move(correctX(45.362), correctY(48.056));
  delay(100);
  move(correctX(44.949), correctY(48.391));
  delay(100);
  move(correctX(44.567), correctY(48.865));
  delay(100);
  move(correctX(44.508), correctY(49.835));
  delay(100);
  move(correctX(44.563), correctY(50.746));
  delay(100);
  move(correctX(44.777), correctY(51.250));
  delay(100);
  move(correctX(45.039), correctY(51.688));
  delay(100);
  move(correctX(45.686), correctY(52.432));
  delay(100);
  move(correctX(46.173), correctY(53.423));
  delay(100);
  move(correctX(49.282), correctY(48.105));
  delay(100);
  move(correctX(48.641), correctY(47.406));
  delay(100);
  move(correctX(47.832), correctY(46.744));
  delay(100);
  move(correctX(47.585), correctY(46.608));
  delay(100);
  move(correctX(46.991), correctY(46.554));
  delay(100);
  move(correctX(46.831), correctY(46.559));
  delay(100);
  move(correctX(46.186), correctY(46.645));
  delay(100);
  move(correctX(45.392), correctY(46.949));
  delay(100);
  move(correctX(44.788), correctY(47.257));
  delay(100);
  move(correctX(44.662), correctY(47.341));
  delay(100);
  move(correctX(44.225), correctY(47.747));
  delay(100);
  move(correctX(43.710), correctY(48.357));
  delay(100);
  move(correctX(43.572), correctY(48.574));
  delay(100);
  move(correctX(43.523), correctY(49.845));
  delay(100);
  move(correctX(43.603), correctY(51.046));
  delay(100);
  move(correctX(43.870), correctY(51.668));
  delay(100);
  move(correctX(44.286), correctY(52.353));
  delay(100);
  move(correctX(44.994), correctY(53.163));
  delay(100);
  move(correctX(45.545), correctY(53.713));
  delay(100);
  move(correctX(45.690), correctY(53.835));
  delay(100);
  move(correctX(46.169), correctY(54.076));
  delay(100);
  move(correctX(46.808), correctY(54.309));
  delay(100);
  move(correctX(47.544), correctY(54.484));
  delay(100);
  move(correctX(48.259), correctY(54.606));
  delay(100);
  move(correctX(49.033), correctY(54.619));
  delay(100);
  move(correctX(49.895), correctY(54.595));
  delay(100);
  move(correctX(50.966), correctY(54.514));
  delay(100);
  move(correctX(51.831), correctY(54.403));
  delay(100);
  move(correctX(53.025), correctY(54.008));
  delay(100);
  move(correctX(53.891), correctY(53.656));
  delay(100);
  move(correctX(54.103), correctY(53.551));
  delay(100);
  move(correctX(54.642), correctY(53.186));
  delay(100);
  move(correctX(55.144), correctY(52.769));
  delay(100);
  move(correctX(55.582), correctY(52.242));
  delay(100);
  move(correctX(55.859), correctY(51.823));
  delay(100);
  move(correctX(55.916), correctY(51.707));
  delay(100);
  move(correctX(56.129), correctY(51.060));
  delay(100);
  move(correctX(56.292), correctY(50.370));
  delay(100);
  move(correctX(56.323), correctY(50.168));
  delay(100);
  move(correctX(56.341), correctY(49.262));
  delay(100);
  move(correctX(56.310), correctY(48.233));
  delay(100);
  move(correctX(56.159), correctY(46.511));
  delay(100);
  move(correctX(56.044), correctY(45.708));
  delay(100);
  move(correctX(55.828), correctY(44.725));
  delay(100);
  move(correctX(55.744), correctY(44.479));
  delay(100);
  move(correctX(54.220), correctY(41.726));
  delay(100);
  move(correctX(52.717), correctY(39.232));
  delay(100);
  move(correctX(52.553), correctY(39.002));
  delay(100);
  move(correctX(52.161), correctY(38.580));
  delay(100);
  move(correctX(51.680), correctY(38.162));
  delay(100);
  move(correctX(50.857), correctY(37.588));
  delay(100);
  move(correctX(49.920), correctY(37.028));
  delay(100);
  move(correctX(49.589), correctY(36.887));
  delay(100);
  move(correctX(48.484), correctY(36.641));
  delay(100);
  move(correctX(47.376), correctY(36.483));
  delay(100);
  move(correctX(46.324), correctY(36.449));
  delay(100);
  move(correctX(45.385), correctY(36.473));
  delay(100);
  move(correctX(44.594), correctY(36.520));
  delay(100);
  move(correctX(43.630), correctY(36.639));
  delay(100);
  move(correctX(43.411), correctY(36.687));
  delay(100);
  move(correctX(41.825), correctY(37.295));
  delay(100);
  move(correctX(40.205), correctY(38.039));
  delay(100);
  move(correctX(39.887), correctY(38.235));
  delay(100);
  move(correctX(39.210), correctY(38.860));
  delay(100);
  move(correctX(38.710), correctY(39.449));
  delay(100);
  move(correctX(38.571), correctY(39.641));
  delay(100);
  move(correctX(37.903), correctY(40.874));
  delay(100);
  move(correctX(37.460), correctY(41.910));
  delay(100);
  move(correctX(37.403), correctY(42.084));
  delay(100);
  move(correctX(37.281), correctY(43.496));
  delay(100);
  move(correctX(37.239), correctY(45.152));
  delay(100);
  move(correctX(37.225), correctY(46.371));
  delay(100);
  move(correctX(37.279), correctY(47.739));
  delay(100);
  move(correctX(37.330), correctY(48.060));
  delay(100);
  move(correctX(37.707), correctY(49.190));
  delay(100);
  move(correctX(38.233), correctY(50.415));
  delay(100);
  move(correctX(39.703), correctY(53.146));
  delay(100);
  move(correctX(41.199), correctY(55.696));
  delay(100);
  move(correctX(41.835), correctY(56.325));
  delay(100);
  move(correctX(42.551), correctY(56.916));
  delay(100);
  move(correctX(43.316), correctY(57.486));
  delay(100);
  move(correctX(44.193), correctY(58.061));
  delay(100);
  move(correctX(46.228), correctY(58.983));
  delay(100);
  move(correctX(47.887), correctY(59.606));
  delay(100);
  move(correctX(48.103), correctY(59.652));
  delay(100);
  move(correctX(48.932), correctY(59.694));
  delay(100);
  move(correctX(49.923), correctY(59.628));
  delay(100);
  move(correctX(51.992), correctY(59.200));
  delay(100);
  move(correctX(53.375), correctY(58.869));
  delay(100);
  move(correctX(54.165), correctY(58.772));
  delay(100);
}

float correctX(float x) {
  return x / 10 - 8;
}

float correctY(float y) {
  return 8 - y / 10;
}
void loop() {
  if (Serial.available() > 0) {
    String input = Serial.readString();

    int x_index = input.indexOf('X');
    int y_index = input.indexOf('Y');

    int g_code = input.substring(1, 2).toInt();
    float px = input.substring(x_index + 1, y_index - 1).toFloat();
    float py = input.substring(y_index + 1).toFloat();

    if (g_code == 1) {
      if (pen_on_top == false) move_up();
    } else {
      if (pen_on_top == true) move_down();
    }
    move(px, py);
  }
}

void move(float px, float py) {
  float c = sqrt(px * px + py * py);

  float theta1 = atan2(py, px) - acos((c * c + l1 * l1 - l2 * l2) / (2 * c * l1));
  float theta2 = acos((l1 * l1 + l2 * l2 - c * c) / (2 * l1 * l2));

  float first_angle = degrees(theta1);
  float second_angle = 180 - degrees(theta2);

  if (isnan(first_angle) || isnan(second_angle) || first_angle < 1 || second_angle < 1 || first_angle > 179 || second_angle > 179) {
    Serial.println("NaN");
  } else {
    servo1.write(first_angle);
    servo2.write(second_angle);
  }
}

void move_up() {
  for (int i = 2; i <= VERTICAL_ANGLE; ++i) {
    servo0.write(i);
    delay(20);
  }
  pen_on_top = true;
}

void move_down() {
  for (int i = 2; i <= VERTICAL_ANGLE; ++i) {
    servo0.write(VERTICAL_ANGLE - i);
    delay(20);
  }
  pen_on_top = false;
}
